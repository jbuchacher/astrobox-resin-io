FROM resin/raspberry-pi3-python:2.7-onbuild

WORKDIR /usr/src/app
RUN mkdir /etc/astrobox
ADD config.yml /etc/astrobox/config.yml

ENV INITSYSTEM on
ENV DBUS_SYSTEM_BUS_ADDRESS "unix:path=/host/run/dbus/system_bus_socket"

RUN apt-get update && apt-get upgrade
RUN apt-get install oracle-java8-jdk
RUN apt-get install python-apt
RUN apt-get install python-gi
RUN apt-get install rubygems
RUN gem install sass

CMD ["python", "run", "--config", "/etc/astrobox/config.yaml"]